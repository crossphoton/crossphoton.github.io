<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Aditya Agrawal | Diploy</title><meta property="og:title" content="Aditya Agrawal | Diploy"><meta property="og:image" content="https://crossphoton.tech/img/bitmoji.webp"><meta name=description content="Deployment utility for linux servers."><meta property="og:description" content="Deployment utility for linux servers."><meta name=author content="Aditya Agrawal"><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2 crossorigin=anonymous><link rel=preload href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:100,200,300,400,500,600,700,800,900&display=swap" as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:100,200,300,400,500,600,700,800,900&display=swap"></noscript><link rel=preload href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i&display=swap" as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i&display=swap"></noscript><link rel=preload href=https://use.fontawesome.com/releases/v5.12.1/css/all.css as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.12.1/css/all.css></noscript><link rel=preload href=https://cdnjs.cloudflare.com/ajax/libs/devicons/1.8.0/css/devicons.min.css integrity="sha512-JW3fT0YTK7pT7w437SoX6GcW76jOZ6E0jGmrqBAcloC4GKT+njHOY4fX5KxJ9WfIXTkNrAF994525fAHp+KCxg==" crossorigin=anonymous as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/devicons/1.8.0/css/devicons.min.css integrity="sha512-JW3fT0YTK7pT7w437SoX6GcW76jOZ6E0jGmrqBAcloC4GKT+njHOY4fX5KxJ9WfIXTkNrAF994525fAHp+KCxg==" crossorigin=anonymous></noscript><link rel=preload href=https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.5.5/css/simple-line-icons.min.css integrity="sha512-QKC1UZ/ZHNgFzVKSAhV5v5j73eeL9EEN289eKAEFaAjgAiobVAnVv/AGuPbXsKl1dNoel3kNr6PYnSiTzVVBCw==" crossorigin=anonymous as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.5.5/css/simple-line-icons.min.css integrity="sha512-QKC1UZ/ZHNgFzVKSAhV5v5j73eeL9EEN289eKAEFaAjgAiobVAnVv/AGuPbXsKl1dNoel3kNr6PYnSiTzVVBCw==" crossorigin=anonymous></noscript><link rel=preload href=https://crossphoton.tech/css/resume.css as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://crossphoton.tech/css/resume.css></noscript><link rel=preload href=https://crossphoton.tech/css/tweaks.css as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://crossphoton.tech/css/tweaks.css></noscript><link rel=preload href=https://crossphoton.tech/css/resume-override.css as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://crossphoton.tech/css/resume-override.css></noscript><meta name=generator content="Hugo 0.68.3"></head><body id=page-top><nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top" id=sideNav><a class="navbar-brand js-scroll-trigger" href=#page-top><span class="d-block d-lg-none">Aditya Agrawal</span>
<span class="d-none d-lg-block"><img class="img-fluid img-profile rounded-circle mx-auto mb-2" src=/img/bitmoji.webp alt></span></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class=navbar-nav><li class=nav-item><a class="nav-link js-scroll-trigger" href=/#about>About</a></li><li class=nav-item><a class="nav-link js-scroll-trigger" href=/#skills>Skills</a></li><li class=nav-item><a class="nav-link js-scroll-trigger" href=/#projects>Projects</a></li><li class=nav-item><a class="nav-link js-scroll-trigger" href=/#education>Education</a></li></ul></div></nav><div class="container-fluid p-0"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://crossphoton.tech/>Home</a></li><li class=breadcrumb-item><a href=https://crossphoton.tech/projects/>Projects</a></li><li class=breadcrumb-item><a href=https://crossphoton.tech/projects/creations/>Creations</a></li><li class="breadcrumb-item active"><a href=https://crossphoton.tech/projects/creations/diploy/>Diploy</a></li></ol></nav><section class="resume-section p-3 p-lg-5 d-flex d-column"><div class=my-auto><h2 class=mb-0><span class=text-primary>Diploy</span></h2><p>This is a utility to manage deployments on a linux server [Might be compatible with other OSs too, didn&rsquo;t test]. It provides an http server for webhooks and CLI for management.</p><h3 id=github-readme-below>GITHUB README BELOW</h3><h2 id=diploy>DIPLOY</h2><p>A utility to manage your linux deployments.</p><h2 id=how-does-it-work>How does it work</h2><ul><li>You start a server using <code>diploy server</code></li><li><strong>diploy</strong> exposes a http server for instructions [take care of <em>firewall</em> !!]</li><li>You create a <code>diploy.yml</code> with below format file and run <code>diploy add</code> in the same directory.</li><li>Now you get endpoits for each configuration you add with the below format.</li><li>Use these as webhooks with Github&mldr; or just manually.</li><li>Or just use the CLI for manual work.</li></ul><h2 id=diployyml>diploy.yml</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>name: &lt;Application Name&gt;    // These should be unique across installation
update:                     // Specify command to update
                            // codebase (optional [default `git pull`])
  command: git pull         // Command/Script to run to update
  type: command             // Whether a script (run using /bin/sh) or command
build:                      // To build stuff
  command: echo This is build
  type: command
run:                        // To start the application
  command: echo This is run
  type: command
</code></pre></div><h2 id=installation>Installation</h2><ul><li>Use the command <code>curl -s https://raw.githubusercontent.com/crossphoton/diploy/main/scripts/install.sh | /bin/sh</code> (This starts the setup too)</li><li>Use <code>go get github.com/crossphoton/diploy</code> and build it</li><li>Clone the repository (or <a href=https://github.com/crossphoton/diploy/archive/refs/heads/main.zip>download ZIP</a>)</li></ul><h2 id=endpoints>endpoints</h2><p>All requests are POST requests.</p><p>For now there is no authentication in this. (See TODO)</p><h4 id=start-processes>Start processes</h4><p>start:</p><ul><li>update codebase: <code>/start/update/{name}</code></li><li>build application: <code>/start/build/{name}</code></li><li>run application: <code>/start/run/{name}</code></li></ul><h4 id=stop-processes-for-a-given-application>Stop processes for a given application</h4><p>stop:
<code>/stop/{name}</code></p><h4 id=run-a-sequence-of-operations>Run a sequence of operations</h4><p><code>/seq/&lt;a>+&lt;b>+&lt;c>/{name}</code></p><h5 id=examples>Examples:</h5><ul><li><code>/seq/stop+update+build+run/golang-app</code></li><li><code>/seq/restart/nodejs-app</code></li><li><code>/seq/update+restart/website</code></li></ul><h3 id=cli-usage>CLI Usage</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>Usage:
  diploy [command]

Available Commands:
  add         add a configuration
  help        Help about any command
  remove      remove a configuaration by name
  server      Start diploy server
  start       start a service with name
  stop        stop a service with name

Flags:
  -h, --help          help for diploy
      --logs string   specify logs location (default &#34;./diploy&#34;)

Use &#34;diploy [command] --help&#34; or &#34;diploy help [command]&#34; for more information about a command.
</code></pre></div><p><strong>Extra:</strong> Use <code>diploy server setup</code> to setup a systemd file.</p><h3 id=caveats>Caveats</h3><ul><li>Processes started with <strong>diploy</strong> will also stop if diploy is stopped.</li></ul><h3 id=cleanup>Cleanup</h3><p>You can use the script if defaults were used during setup</p><p><code>curl -s https://raw.githubusercontent.com/crossphoton/diploy/main/scripts/cleanup.sh | /bin/sh</code></p><h3 id=troubleshooting>Troubleshooting</h3><ul><li>If problems with database: Specify logs location using <code>--logs</code> flag</li><li>If problems with connection: Specify server address using <code>--addr</code> flag</li></ul><h3 id=todo>Todo</h3><p>See the dedicated <a href=./TODO.md>TODO</a> file.</p><h3 id=stuff-used>Stuff Used</h3><ul><li>gorm + sqlite</li><li>gorilla/mux</li><li>cobra</li><li>go-yaml</li></ul><p>Project link: <a href=https://github.com/crossphoton/diploy>https://github.com/crossphoton/diploy</a></p><ul class=tags><li><a class=tag href=/tags/linux>linux</a></li><li><a class=tag href=/tags/webhooks>webhooks</a></li><li><a class=tag href=/tags/deployment>deployment</a></li><li><a class=tag href=/tags/sqlite>sqlite</a></li><li><a class=tag href=/tags/golang>golang</a></li><li><a class=tag href=/tags/cobra>cobra</a></li></ul></div></section><span style=color:#999;font-size:60%>Nifty <a href=https://codepen.io/wbeeftink/pen/dIaDH>tech tag lists</a> from <a class=pen-owner-link href=https://codepen.io/wbeeftink>Wouter Beeftink</a></span></div><script src=https://code.jquery.com/jquery-3.5.1.slim.min.js integrity=sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js integrity=sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx crossorigin=anonymous></script><script async src=https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js integrity="sha512-0QbL0ph8Tc8g5bLhfVzSqxe9GERORsKhIn1IrpxDAgUsbBGz/V7iSav2zzW325XGd1OMLdL4UiqRJj702IeqnQ==" crossorigin=anonymous></script><script async src=/js/resume.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-XPQF8X0C5Z"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-XPQF8X0C5Z');</script></body></html>